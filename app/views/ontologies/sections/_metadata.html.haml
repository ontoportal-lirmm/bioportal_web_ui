= turbo_frame_tag 'summary', target:"_top" do
  = not_ready_submission_alert(submission: @submission_latest)
  .summary-page-center
    .summary-page-first-row
      = render partial: 'ontologies/sections/metadata/ontology_description_section'
      = render partial: 'ontologies/sections/metadata/ontology_fairness_section'
      = render partial: 'ontologies/sections/metadata/ontology_relations_network'
      = render partial: 'ontologies/sections/metadata/ontology_submissions_section'
      = render partial: 'ontologies/sections/metadata/ontology_metrics_section'
    .summary-page-second-row
      = ontology_depiction_card
      = properties_card('Identifiers','Principal identifiers of the ontology.', @identifiers) do |values|
        = horizontal_list_container(values) do |v|
          = render LinkFieldComponent.new(value: v, check_resolvability: true)

      = properties_dropdown('dates','Dates','', @dates_properties) do |values|
        - Array(values).sort.map do |v|
          %div
            = render DateTimeFieldComponent.new(value: v)

      = properties_dropdown('person_and_organization','Persons and organizations','', @agents_properties) do |values|
        = horizontal_list_container(values) do |v|
          = agent_chip_component(v)

      = properties_dropdown('link','Other links','Metadata properties that highlight the links enabling access to datasets, downloading semantic resources, etc', @links_properties) do |values|
        = horizontal_list_container(values) do |v|
          = render LinkFieldComponent.new(value: v, raw: true)
      = properties_dropdown('projects_section','Projects and usage information','Details pertaining to the utilization of the ontology.', nil) do |c|
        - c.row do
          = projects_field(@projects)
        - properties_list_component(c, @projects_properties)
      :javascript
        var projectsUrl = document.location.hash
        if (projectsUrl ==  "#projects_section"){
            document.querySelector("[data-target='#projects_section']")?.click()
        }
      = properties_dropdown('methodology','Methodology and provenance', 'Metadata properties primarily encompass the design, methods, and actions to create the ontology. This includes elements such as the tools and software employed by the creator of the ontology during its configuration.', @methodology_properties)
      = properties_dropdown('community','Community', 'Metadata properties primarily encompass the design, methods, and actions to create the ontology. This includes elements such as the tools and software employed by the creator of the ontology during its configuration.', nil ) do |c|
        - properties_list_component(c, @community_properties)
        - unless Array(@ontology.group).empty?
          - c.row do
            = render FieldContainerComponent.new(label: 'Groups') do
              = horizontal_list_container(@ontology.group) do |v|
                = render ChipButtonComponent.new(text: show_group_name(v), type: "static")

      = properties_dropdown('content','Content', 'Metadata properties primarily encompass the design, methods, and actions to create the ontology. This includes elements such as the tools and software employed by the creator of the ontology during its configuration.', nil) do |c|
        - properties_list_component(c, @content_properties.reject{|k, v| %w[keyClasses metadataVoc].include?(k.to_s)})
        - c.row do
          = render FieldContainerComponent.new(label: attr_label('metadataVoc', attr_metadata: attr_metadata("metadataVoc"), show_tooltip: false)) do
            = Array(@content_properties['metadataVoc']).map{|x| metadata_vocabulary_display(x)}.join.html_safe
      = render Layout::CardComponent.new do |c|
        - c.header do  |h|
          - h.text do
            Visits
            - if visits_data(@ontology)
              = link_to(@ontology.links["analytics"] + "?apikey=#{get_apikey}&format=csv", title: "Download as CSV") do
                = inline_svg("summary/download.svg", width: '30px', height: '20px')

        = render Layout::ListComponent.new do |l|
          - l.row do
            = render partial: "visits"

      - unless @ontology.view?
        = render Layout::CardComponent.new do |d|
          - d.header do |h|
            - h.text do
              Views of #{@ontology.acronym}
              = new_element_link('Create new view', new_view_path(@ontology.id))
          = render Layout::ListComponent.new do |l|
            - l.row do
              = render partial: 'ontology_views'

      - unless @submission_latest.nil?
        = javascript_include_tag("jsonld")
        = metadata_formats_buttons

      = admin_block do
        = properties_dropdown('configuration','Configuration metadata', 'Regroup all the metadata properties used by the portal to configure the behavior of the resource', @config_properties)
