.search-page-container 
  .search-page-subcontainer{'data-controller': 'reveal-component'}
    = form_tag(search_path, method: :get, 'data-turbo': true) do
      .search-page-input-container{'data-controller': 'reveal'}
        .search-page-input
          %input{type:"text", placeholder:"Enter a term, e.g. Melanoma", name: "q", value: @search_query}
          %button.search-page-button{type:'submit'}
            = inline_svg_tag 'icons/search.svg'

        .search-page-advanced{'data-reveal-component-target': 'item', class: "#{@advanced_options_open ? '' : 'd-none'}"}
          .left
            .filter-container
              .title
                Search language
              .field
                = search_language_selector(name: 'lang', selected: params[:lang])
                
            .filter-container
              .title
                = t("search.ontologies")
              .field
                - get_ontologies_data
                = render Input::SelectComponent.new(id: 'search-ontologies', name: 'ontologies_list[]', value: @onts_for_select, multiple: "multiple", selected:  params[:ontologies_list])
          
          .right 
            .filter-container
              .title
                Include in search
              .d-flex
                = render(ChipsComponent.new(name: 'include_properties', label: 'Property values', checked:  params[:include_properties]))
                = render(ChipsComponent.new(name: 'obsolete', label: 'Obsolete classes', checked:  params[:obsolete]))
                = render(ChipsComponent.new(name: 'include_views', label: 'Ontology views', checked: params[:include_views]))

            .filter-container
              .title
                Show only
              .d-flex
                = render(ChipsComponent.new(name: 'exact_match', label: 'Exact Matches',  checked:  params[:exact_match]))
                = render(ChipsComponent.new(name: 'require_definition', label: 'Classes with definitions', checked: params[:require_definition]))

        .search-page-options
          - if @search_results
            .search-page-number-of-results 
              = "Match in #{@search_results.length} ontologies"
          .search-page-advanced-button.show-options{class: "#{@advanced_options_open ? 'd-none' : ''}",'data': {'action': 'click->reveal-component#show', 'reveal-component-target': 'showButton'}}
            .icon
              =inline_svg_tag 'icons/settings.svg'
            .text
              Show advanced options
          .search-page-advanced-button.hide-options{class: "#{@advanced_options_open ? '' : 'd-none'}", 'data': {'action': 'click->reveal-component#hide', 'reveal-component-target': 'hideButton'}}
            .icon
              =inline_svg_tag 'icons/hide.svg'
            .text
              hide advanced options
    - if @search_results
      .search-page-results-container
        - number = 0
        - @search_results.each do |result|
          .search-page-result-element
            - number = number + 1
            - descendants = result[:descendants]
            - reuses = result[:reuses]
            - result[:root][:number] = number
            = render Display::SearchResultComponent.new(result[:root]) do |c|
              - descendants.each { |d| c.subresult(d.merge(is_sub_component: true))}
              - reuses.each do |r|
                - c.reuse(r[:root].merge(is_sub_component: true)) do |b|
                  - r[:descendants].each { |dd|  b.subresult(dd.merge(is_sub_component: true))}
    
    - if @search_results.empty? && !@search_query.empty?
      .browse-empty-illustration
        %img{:src => "#{asset_path("empty-box.svg")}"}
        %p No result was found
          

